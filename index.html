<!--
    1. Create a website using HTML and host locally using VSCode's Live Server extension.
    2. Integrate APIs built in R (plumber), Python (flask), and JavaScript (express).
    3. Enable each API to interact with a local instance of a Microsoft SQL Server datase.
    4. Upon button click, each API writes a different record to the database.
    5. Current database table is displayed in the browser.
-->   

<body style="padding: 0 15%; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh;">
    <table style="table-layout: fixed; width: 100%;">
        <tr height = "20px">
            <h1>Project Connect</h1>
        </tr>
        <tr height = "200px">
            <td style="width: 33.33%; text-align: center;">
                <img src="images/r.png" height="80px">
                <br><br>
                <button id="r-button" style = "width: 150px; height: 30px;">R is the best!</button>
                <br><br>
                <p id="r-output-text">Text output from R's API</p>
            </td>
            <td style="width: 33.33%; text-align: center;">
                <img src="images/python.png" height="80px">
                <br><br>
                <button id="py-button" style = "width: 150px; height: 30px;">Python is the best!</button>
                <br><br>
                <p id="py-output-text">Text output from Python's API</p>
            </td>
            <td style="width: 33.33%; text-align: center;">
                <img src="images/javascript.png" height="80px">
                <br><br>
                <button id="js-button" style = "width: 150px; height: 30px;">JavaScript is the best!</button>
                <br><br>
                <p id="js-output-text">Text output from JavaScript's API</p>
            </td>
        </tr>
        <tr height = "20px"></tr>
        <tr height = "300px">
            <td id = "r-output-table" style = "width: 33.33%; text-align: center;">
                <!-- Display database table here -->
                <p>Data output from R's API</p>
            </td>
            <td id = "py-output-table" style = "width: 33.33%; text-align: center;">
                <!-- Display database table here -->
                <p>Data output from Python's API</p>
            </td>
            <td id = "js-output-table" style = "width: 33.33%; text-align: center;">
                <!-- Display database table here -->
                <p>Data output from JavaScript's API</p>
            </td>
        </tr>
    </table>

    <script>
        // Function to handle button clicks
        function handleButtonClick(apiEndpoint, outputElementText, outputElementData) {
            fetch(apiEndpoint)
                .then(response => response.json())
                .then(data => {
                    // Update the specific element with the response data
                    document.getElementById(outputElementText).innerText = data.message;
                    //document.getElementById(outputElementData).innerText = data.data;

                    // Assuming 'data' is an array of strings
                    //const formattedData = data.join('<br>'); // Join the array elements with <br> for newline in HTML
                    //document.getElementById(outputElementData).innerHTML = formattedData;

                    // Check if 'data' is an array and join the elements with <br> tag for line breaks
                    if(Array.isArray(data.data)){
                        const formattedData = data.data.join('<br>');
                        document.getElementById(outputElementData).innerHTML = formattedData;
                    } else {
                    // If 'data' is not an array, just display it
                    document.getElementById(outputElementData).innerText = data.data;
                    }
        
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    
        // Add event listeners to each button
        document.getElementById('r-button').addEventListener('click', () => handleButtonClick('http://localhost:8000/r-api', 'r-output-text', 'r-output-table'));        
        document.getElementById('py-button').addEventListener('click', () => handleButtonClick('http://127.0.0.1:5000/py-api', 'py-output-text', 'py-output-table'));
        document.getElementById('js-button').addEventListener('click', () => handleButtonClick('http://localhost:8000/javascript-api-endpoint', 'js-output-text', 'js-output-table'));
    </script>

</body>