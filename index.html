<!--
    1. Create a website using HTML and host locally using VSCode's Live Server extension.
    2. Integrate APIs built in R (plumber), Python (flask), and JavaScript (express).
    3. Enable each API to interact with a local instance of a Microsoft SQL Server datase.
    4. Upon button click, each API writes a different record to the database.
    5. Current database table is displayed in the browser.
-->   

<body style="padding: 0 15%; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh;">
    <table>
        <tr>
            <td width="20%" style="text-align: center;">
                <img src="images/r.png" height="80px">
                <br><br>
                <button id="r-button" style = "width: 150px; height: 30px;">R is the best</button>
                <br><br>
                <p id="r-output">R output will be displayed here.</p>
            </td>
            <td width="20%" style="text-align: center;">
                <img src="images/python.png" height="80px">
                <br><br>
                <button id="py-button" style = "width: 150px; height: 30px;">Python is the best</button>
            </td>
            <td width="20%" style="text-align: center;">
                <img src="images/javascript.png" height="80px">
                <br><br>
                <button id="js-button" style = "width: 150px; height: 30px;">JavaScript is the best</button>
            </td>
        </tr>
        <tr height = "100px"></tr>
        <tr>
            <td colspan="3" style="text-align: center;">
                <!-- Display database table here -->
                <p>Display database table here.</p>

                <table id="data-table">
                    <thead>
                        <tr>
                            <th>API Outputs</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data rows will be inserted here -->
                    </tbody>
                </table>
                

                <button style = "width: 150px; height: 30px;">Start over</button>
            </td>
        </tr>

    </table>

    <script>
        // Function to handle button clicks
        function handleButtonClick(apiEndpoint, outputElementText, outputElementData) {
            fetch(apiEndpoint)
                .then(response => response.json())
                .then(data => {
                    // Update the specific element with the response data
                    document.getElementById(outputElementText).innerText = data.message;
                    //document.getElementById(outputElementData).innerText = data.data;

                    // Assuming 'data' is an array of strings
                    //const formattedData = data.join('<br>'); // Join the array elements with <br> for newline in HTML
                    //document.getElementById(outputElementData).innerHTML = formattedData;

                    // Check if 'data' is an array and join the elements with <br> tag for line breaks
                    if(Array.isArray(data.data)){
                        const formattedData = data.data.join('<br>');
                        document.getElementById(outputElementData).innerHTML = formattedData;
                    } else {
                    // If 'data' is not an array, just display it
                    document.getElementById(outputElementData).innerText = data.data;
                    }
        
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    
        // Add event listeners to each button
        document.getElementById('r-button').addEventListener('click', () => handleButtonClick('http://localhost:8000/r-api', 'r-output', 'data-table'));        
        document.getElementById('py-button').addEventListener('click', () => handleButtonClick('http://localhost:8000/python-api-endpoint', 'some-python-output-element-id'));
        document.getElementById('js-button').addEventListener('click', () => handleButtonClick('http://localhost:8000/javascript-api-endpoint', 'some-javascript-output-element-id'));
    </script>

</body>